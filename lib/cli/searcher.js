#!/usr/bin/env node
"use strict";var e=require("@debut/plugin-utils"),t=require("./genetic-8697fca0.js");require("cli-progress"),require("./tester-transport-0f71243c.js"),require("binance-api-node"),require("async-genetic"),require("@master-chief/alpaca"),require("@tinkoff/invest-openapi-js-sdk");const r=864e5,i=e.cli.getArgs(),{bot:a,ticker:s,log:n,amount:o=1e4,days:c=1e3,hours:u=0,gen:l=12,pop:g=2e3,ohlc:p,gap:d=0,best:f=5,daysForStudy:m=2,daysForTrade:b=1}=i;let k=Number(o);const q=e.cli.getBotData(a);function y(e){return~~(e/r)*r}!async function(){if(!q)return void process.stdout.write("Genetic CLI error: Incorrect configuration");const{configs:i,meta:a}=q,b=y((new Date).getTime());for(let q=c;0!=q;q--){const c={...i[s],ticker:s,amount:Number(o)},h={days:m,hours:u,generations:l,populationSize:g,log:n,ohlc:p,gapDays:Number(d)+Number(q),validateSchema:a.validate,score:a.score,stats:a.stats,create:a.create,ticksFilter:a.ticksFilter,best:f},v=new t.GeneticWrapper(h);let F=await v.start(a.parameters,c);F=F.map(((e,t)=>(e.config.id=t,e)));const w=F[0].config;w.amount=k;let D=y(b-r*q),j=new Date(D),N=1+j.getMonth(),S=j.getFullYear()+"-"+N+"-"+j.getDate();const $=`public/data/tickers/${w.ticker}/${w.interval}/${S}.json`;e.file.ensureFile($),e.file.saveFile($,w)}}();
