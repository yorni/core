#!/usr/bin/env node
"use strict";var e=require("@debut/plugin-utils"),t=require("./genetic-8697fca0.js");require("async-genetic"),require("./tester-transport-0f71243c.js"),require("cli-progress"),require("@master-chief/alpaca"),require("binance-api-node"),require("@tinkoff/invest-openapi-js-sdk");const r=e.cli.getArgs(),{bot:i,ticker:a,log:s,amount:c=1e4,days:n=1e3,gen:o=12,pop:l=2e3,ohlc:p,gap:u=0,crypt:g}=r,f=e.cli.getBotData(i);!async function(){if(!f)return void process.stdout.write("Genetic CLI error: Incorrect configuration");const r={score:f.meta.score,stats:f.meta.stats,ticksFilter:f.meta.ticksFilter,validateSchema:f.meta.validate,create:f.meta.create,days:n,generations:o,populationSize:l,log:s,ohlc:p,gapDays:u},{configs:d,meta:m}=f,v=Object.keys(d),k=d[a||v[0]];m.validate&&(r.validateSchema=m.validate);const q=g?"crypt.json":"stocks.json",y=JSON.parse(e.file.readFile(q)),j=y.pop();if(!j)return;const b=new t.GeneticWrapper(r),h={...k,ticker:j,amount:Number(c)};e.file.saveFile(q,y);let F=await b.start(m.parameters,h);const S=`public/reports/${i}/${h.interval}/tickers/${j}.json`;F=F.map(((e,t)=>(e.config.id=t,e))).filter((e=>e.stats)),F.length&&(e.file.ensureFile(S),e.file.saveFile(S,F))}();
