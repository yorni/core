#!/usr/bin/env node
"use strict";var e=require("./tester-transport-0f71243c.js"),t=require("@debut/plugin-utils");require("cli-progress"),require("@master-chief/alpaca"),require("binance-api-node"),require("@tinkoff/invest-openapi-js-sdk");const r=t.cli.getArgs(),{bot:i,ticker:o,days:s=1e3,ohlc:c,gap:n=0}=r,a=t.cli.getBotData(i);!async function(){if(!a)return void process.stdout.write("Genetic CLI error: Incorrect configuration");const{configs:t,meta:r}=a;!async function(t,r){try{const i=new e.TesterTransport({ohlc:c,comission:t.fee,broker:t.broker,ticker:t.ticker}),o=await r.create(i,t,1);t||process.stdout.write("Genetic CLI error: Put config in bot cfgs.ts file");const{broker:a="tinkoff",ticker:l,interval:f}=t;let u=await e.getHistory({broker:a,ticker:l,interval:f,days:s,gapDays:n});r.ticksFilter&&(u=u.filter(r.ticksFilter(t))),console.log("\n---- Tinkoff ["+t.ticker+"] ----\n"),console.log("Tested in ",u.length," candles..."),i.setTicks(u),await o.start(),await i.run(),await o.closeAll(),await o.dispose(),console.log(r.stats(o))}catch(e){console.log(e)}}(t[o],r)}();
